{% extends 'cr/home.html' %}
{% block content %}
<h1>{{card.name}}</h1>

<hr>
    <div>
        <div>
            <h3><span>{{ card.name }}</span></h3>
            <p>Level: {{ card.level }}</p>
            <p>Rarity: {{ card.rarity }}</p>
            {% if card.cost > 0 %}
                <p>Elixir Cost: {{ card.cost }}</p>
            {% else %}
                <p>Elixir Cost: Free</p>
            {% endif %}
            <div>
                <a href="{% url 'cards_update' card.id %}">EDIT</a>
                <a href="{% url 'cards_delete' card.id %}">DELETE</a>
            </div>
        </div>
    </div>

<form action="{% url 'add_status' card.id %}" method="POST">
    {% csrf_token %}
    {{ status_form.as_p }}
    <input type="submit" value="Add Level"/>
</form>

<!-- This is the Markup for showing the cards' statuses.  -->
<div>
    <h3>Level Status</h3>
    <table>
        <thread>
            <tr><th>Date</th><th>Level</th></tr>
        </thread>
        <tbody>
            {% for status in card.status_set.all %}
            <tr>
                <td>{{status.date}}</td>
                <td>{{status.get_status_display}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
    <hr>

    <div>
        <h3>{{ card.name }}'s Players</h3>
        {% if card.players.count %}
            {% for player in card.players.all %}
                <h1>{{player.player_name}}</h1>
                <div>
                    <form action="{% url 'assoc_delete' card.id player.id %}" method="POST">
                        {% csrf_token %}
                        <button type="submit">REMOVE</button>
                    </form>
                </div>
            {% endfor %}
        {% else %}
            <h4>No Gaming Buddies</h4>
        {% endif %}
    </div>

    <div>
        <h3>Local Players</h3>
        {% if players.count %}
            {% for player in players.all %}
            <h5>{{player.player_name}}</h5>
            <form action="{% url 'assoc_player' card.id player.id %}" method="POST">
                {% csrf_token %}
                <button type="submit">ADD FRIEND</button>
            </form>
            {% endfor %}
        {% else %}
            <h5>{{card.name}} is Friends with Everyone!</h5>
        {% endif %}
    </div>

{% endblock %}